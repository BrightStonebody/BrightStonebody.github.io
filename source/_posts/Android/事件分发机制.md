---
title: 事件分发机制
date: 2019-08-13 21:12:59
tags:
- Android
- View
Categories:
- Android
- View
---

# 事件分发机制

# dispatchTouchEvent

## ViewGroup的dispatchTouchEvent方法

### 伪代码
```
public boolean dispatchTouchEvent(){
    boolean consume = false;
    if (onInterceptTouchEvent(ev)){
        consume = super.dispatchTouchEvent();
    }else{
        consume = child.dispatchTouchEvent(ev);
        if (!consume)
            consume = super.dispatchTouchEvent(ev)
    }
    return consume;
}
```
解释：
在dispatchTouchEvent方法中，onInterceptTouchEvent方法会判断当前ViewGroup是否会拦截，若拦截，则交给自己处理，若不拦截，则交给子view。若子view不能处理，则还是由自己来处理

### 各种事件action
#### ActionDown
ActionDown事件是一个事件序列的开始。当ActionDown事件被ViewGroup拦截，则这个事件剩下的事件将不会通过onInterceptTouchEvent方法，而是直接交给ViewGroup处理
#### ActionMove、ActionUp等其他事件
若ActionDown没有被ViewGroup拦截，则其他的事件每次都会经过ViewGroup的onInterceptTouchEvent方法判断是否拦截

## View的dispatchTouchEvent方法

如果有onTouchListener，优先执行onTouch方法，如果onTouch方法返回true，则不执行onTouchEvent方法
